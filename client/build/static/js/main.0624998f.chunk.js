(this["webpackJsonpidle-rpg-front"]=this["webpackJsonpidle-rpg-front"]||[]).push([[0],{126:function(e,t,n){},132:function(e,t,n){},143:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(19),c=n.n(i),o=(n(126),n(22)),s=n(68),l=n(29),d=n(18),u=(n(132),n(183)),j=n(10),b=Object(a.createContext)(void 0);function h(){return Object(a.useContext)(b)}var m={isAuthenticated:!1,signin:function(e){m.isAuthenticated=!0,e()},signout:function(e){m.isAuthenticated=!1,e()}};var O=n(174),v=n(177),f=n(179),g=n(144),p=n(192),x=n(3),y=Object(O.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},link:{textDecoration:"none",color:"white"}}}));function k(){var e=y(),t=Object(d.g)(),n=h();return Object(x.jsx)(v.a,{position:"static",children:Object(x.jsxs)(f.a,{children:[Object(x.jsx)(g.a,{variant:"h6",className:e.title,children:Object(x.jsx)(l.b,{to:"/",className:e.link,children:"Mon petit RPG"})}),(null===n||void 0===n?void 0:n.token)?Object(x.jsx)(p.a,{color:"inherit",onClick:function(){return n.signout((function(){return t.push("/")}))},children:"Me deconnecter"}):Object(x.jsx)(p.a,{color:"inherit",children:Object(x.jsx)(l.b,{to:"/character-select",className:e.link,children:"Me connecter"})})]})})}var I=n(86),S=n(113),C=n(190),w=n(35),N=n.n(w),M=n(45),q=n(38),T=n(182),D=n(115),P=n(34);function A(e,t){return F.apply(this,arguments)}function F(){return(F=Object(M.a)(N.a.mark((function e(t,n){var a,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={playerId:t,opponentId:n},e.next=3,fetch("api/fight",{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}});case 3:return e.next=5,e.sent.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E,L=n(180),$=n(181);function W(e){var t,n,a,r,i,c;return e.character?Object(x.jsx)(L.a,{children:Object(x.jsx)($.a,{children:Object(x.jsxs)(T.a,{container:!0,justify:"center",alignContent:"center",alignItems:"center",direction:"column",children:[Object(x.jsx)(g.a,{variant:"h5",children:null===(t=e.character)||void 0===t?void 0:t.name}),Object(x.jsxs)(g.a,{variant:"h6",children:["Niveau: ",null===(n=e.character)||void 0===n?void 0:n.rank]}),Object(x.jsxs)(g.a,{variant:"h6",children:["Endurance: ",null===(a=e.character)||void 0===a?void 0:a.health]}),Object(x.jsxs)(g.a,{variant:"h6",children:["Attaque: ",null===(r=e.character)||void 0===r?void 0:r.attack]}),Object(x.jsxs)(g.a,{variant:"h6",children:["D\xe9fense: ",null===(i=e.character)||void 0===i?void 0:i.defense]}),Object(x.jsxs)(g.a,{variant:"h6",children:["Magik: ",null===(c=e.character)||void 0===c?void 0:c.magik]})]})})}):Object(x.jsx)(x.Fragment,{})}var V=Object(P.a)(E||(E=Object(q.a)(["\n    query fight($charId: String!){\n        fightSetting(charId: $charId){\n            player{\n                id,\n                name,\n                health, \n                attack,\n                defense, \n                magik,\n                rank\n            },\n            opponent{\n                id,\n                name,\n                health, \n                attack,\n                defense, \n                magik,\n                rank\n            }\n        }\n    }\n"])));function z(e){var t=Object(d.g)(),n=e.charId;console.log(n);var r=Object(a.useState)(n),i=Object(j.a)(r,1)[0],c=Object(o.useLazyQuery)(V,{fetchPolicy:"network-only",variables:{charId:n}}),s=Object(j.a)(c,2),l=s[0],b=s[1].data,h=Object(a.useState)(null===b||void 0===b?void 0:b.fightSetting.opponent),m=Object(j.a)(h,2),O=m[0],v=m[1],f=Object(a.useState)(null===b||void 0===b?void 0:b.fightSetting.player),y=Object(j.a)(f,2),k=y[0],I=y[1],S=Object(a.useState)(),C=Object(j.a)(S,2),w=C[0],q=C[1],P=Object(a.useState)(),F=Object(j.a)(P,2),E=F[0],L=F[1],$=Object(a.useState)(!1),z=Object(j.a)($,2),J=z[0],R=z[1],B=Object(a.useState)(!1),G=Object(j.a)(B,2),Q=G[0],U=G[1];return Object(a.useEffect)((function(){O||k||l(),(null===b||void 0===b?void 0:b.fightSetting)&&(v(b.fightSetting.player),I(b.fightSetting.opponent)),w&&U(!0)}),[i,l,w,b,k,O]),Object(a.useEffect)((function(){function e(){return(e=Object(M.a)(N.a.mark((function e(t,n){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t,n);case 2:a=e.sent,console.log(a),q(a.reportList),L(a.winner);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}J&&!Q&&function(t,n){e.apply(this,arguments)}(i,null===k||void 0===k?void 0:k.id)}),[J,null===k||void 0===k?void 0:k.id,i,Q]),Object(x.jsx)(u.a,{style:{padding:"1rem"},children:Object(x.jsxs)(T.a,{container:!0,direction:"column",alignItems:"center",justify:"center",children:[Object(x.jsxs)(T.a,{container:!0,item:!0,justify:"center",direction:"column",alignItems:"center",children:[Object(x.jsxs)(T.a,{container:!0,item:!0,xs:6,direction:"row",justify:"space-evenly",alignItems:"center",style:{padding:"1rem"},children:[Object(x.jsx)(W,{character:O}),Object(x.jsx)(g.a,{variant:"h4",children:"VS"}),Object(x.jsx)(W,{character:k})]}),Object(x.jsx)(p.a,{color:"primary",variant:"contained",disabled:J||Q,onClick:function(){R(!0)},children:"Attaquer !"})]}),Object(x.jsx)(T.a,{container:!0,item:!0,alignItems:"center",justify:"center",children:w?Object(x.jsxs)(T.a,{container:!0,item:!0,direction:"column",justify:"center",alignItems:"center",style:{padding:"1rem"},children:[Object(x.jsx)(g.a,{variant:"h5",children:E?"VICTOIRE":"DEFAITE"}),Object(x.jsx)(p.a,{variant:"contained",color:"primary",onClick:function(){t.goBack()},style:{padding:"1rem",margin:"auto"},children:"Revenir \xe0 la selection de personnage"})]}):void 0}),Object(x.jsx)(T.a,{item:!0,container:!0,direction:"column",xs:6,justify:"space-evenly",spacing:1,children:null===w||void 0===w?void 0:w.map((function(e){return Object(x.jsx)(T.a,{item:!0,container:!0,direction:"column",justify:"center",children:Object(x.jsx)(D.a,{children:Object(x.jsxs)(T.a,{item:!0,container:!0,direction:"column",justify:"center",alignItems:"center",children:[Object(x.jsxs)(g.a,{children:["Tour n\xb0 ",e.roundNumber," :"]}),Object(x.jsxs)(g.a,{children:[null===O||void 0===O?void 0:O.name," inflige ",e.player.attackValue," points de d\xe9gats"]}),Object(x.jsxs)(g.a,{children:[null===k||void 0===k?void 0:k.name," perd ",e.enemy.healthLost," points de vie"]}),Object(x.jsxs)(g.a,{children:[null===k||void 0===k?void 0:k.name," inflige ",e.enemy.attackValue," points de d\xe9gats"]}),Object(x.jsxs)(g.a,{children:[null===O||void 0===O?void 0:O.name," perd ",e.player.healthLost," points de vie"]})]})})},null===w||void 0===w?void 0:w.indexOf(e))}))})]})})}var J,R=n(112),B=n(194),G=n(184),Q=n(185),U=n(186),H=n(191),_=n(189),K=n(187),X=n(188),Y=Object(O.a)((function(e){return{form:{width:"100%",marginTop:e.spacing(1)}}})),Z=Object(P.a)(J||(J=Object(q.a)(["\n    mutation editCharacter($char: CharacterInput!) {\n        editCharacter(character: $char){\n            id\n            name\n            rank\n            skillpoints\n            health\n            attack\n            defense\n            magik\n            userId\n        }\n    }\n        \n"])));function ee(e){var t,n=Object(a.useState)(e.open),r=Object(j.a)(n,2),i=r[0],c=r[1],s=Object(a.useState)(null!==(t=e.character)&&void 0!==t?t:{name:"",skillpoints:12,health:10,attack:0,defense:0,magik:0,rank:1}),l=Object(j.a)(s,1)[0],d=Object(o.useMutation)(Z),u=Object(j.a)(d,1)[0],b=Object(a.useState)(),h=Object(j.a)(b,2),m=h[0],O=h[1],v=Object(a.useState)(l.skillpoints),f=Object(j.a)(v,2),g=f[0],y=f[1],k=Object(a.useState)(l.health),I=Object(j.a)(k,2),S=I[0],C=I[1],w=Object(a.useState)(l.attack),N=Object(j.a)(w,2),M=N[0],q=N[1],D=Object(a.useState)(l.defense),P=Object(j.a)(D,2),A=P[0],F=P[1],E=Object(a.useState)(l.magik),L=Object(j.a)(E,2),$=L[0],W=L[1],V=Y(),z=function(){c(!1)};Object(a.useEffect)((function(){e.open&&c(e.open)}),[e]);var J=function(e){switch(e){case"health":return{value:S,handler:C};case"attack":return{value:M,handler:q};case"defense":return{value:A,handler:F};case"magik":return{value:$,handler:W};default:return{value:0,handler:function(){console.error("Attribute not found")}}}},R=function(e){var t=J(e),n="health"===e?1:Math.ceil((null===t||void 0===t?void 0:t.value)/5);g>0&&(0===n&&(n=1),g>=n&&t.handler((null===t||void 0===t?void 0:t.value)+1),y(g-n<0?0:g-n))},ee=function(e){var t=J(e),n="health"===e?1:Math.ceil((null===t||void 0===t?void 0:t.value)/5);g<S+M+A+$+g&&(0===n&&(n=1),(t.value-1>=0||t.value-1>=l[e])&&t.handler(t.value-1),y(g+n))},te=function(e,t){var n=J(e);if("add"===t){var a="health"===e?1:Math.ceil((null===n||void 0===n?void 0:n.value)/5);if(g<a)return!0}else if(l&&l[e]===n.value)return!0},ne=function(e){O(e.target.value)};return Object(x.jsxs)(B.a,{open:i,onClose:z,children:[Object(x.jsx)(G.a,{}),Object(x.jsxs)(Q.a,{children:[e.character?"Editer":"Cr\xe9er"," un Personnage"]}),Object(x.jsxs)("form",{onSubmit:function(t){var n;t.preventDefault();var a={id:null!==(n=l.id)&&void 0!==n?n:void 0,name:m,health:S,attack:M,defense:A,magik:$,skillpoints:g,rank:l.rank,userId:e.userId};console.log(a),u({variables:{char:a}}),e.action(!0),c(!1)},className:V.form,children:[Object(x.jsx)(U.a,{children:Object(x.jsxs)(T.a,{container:!0,direction:"column",justify:"center",children:[e.character?Object(x.jsx)(H.a,{name:"name",label:"Nom",id:"name",required:!0,margin:"normal",value:null===l||void 0===l?void 0:l.name,onChange:ne,disabled:!0}):Object(x.jsx)(H.a,{name:"name",label:"Nom",id:"name",required:!0,margin:"normal",onChange:ne}),Object(x.jsx)(H.a,{name:"skillpoints",label:"Points de comp\xe9tence",id:"skillpoints",disabled:!0,value:g,margin:"normal"}),Object(x.jsxs)(T.a,{container:!0,item:!0,direction:"row",justify:"center",children:[Object(x.jsx)(p.a,{color:"primary",onClick:function(){return ee("health")},disabled:te("health","remove"),children:Object(x.jsx)(K.a,{})}),Object(x.jsx)(H.a,{name:"health",label:"Endurance",id:"health",disabled:!0,value:S,margin:"normal"}),Object(x.jsx)(p.a,{color:"primary",onClick:function(){return R("health")},disabled:te("health","add"),children:Object(x.jsx)(X.a,{})})]}),Object(x.jsxs)(T.a,{container:!0,item:!0,direction:"row",justify:"center",children:[Object(x.jsx)(p.a,{color:"primary",onClick:function(){return ee("attack")},disabled:te("attack","remove"),children:Object(x.jsx)(K.a,{})}),Object(x.jsx)(H.a,{name:"attack",label:"Attaque",id:"attack",disabled:!0,value:M,margin:"normal"}),Object(x.jsx)(p.a,{color:"primary",onClick:function(){return R("attack")},disabled:te("attack","add"),children:Object(x.jsx)(X.a,{})})]}),Object(x.jsxs)(T.a,{container:!0,item:!0,direction:"row",justify:"center",children:[Object(x.jsx)(p.a,{color:"primary",onClick:function(){return ee("defense")},disabled:te("defense","remove"),children:Object(x.jsx)(K.a,{})}),Object(x.jsx)(H.a,{name:"defense",label:"Defense",id:"defense",disabled:!0,value:A,margin:"normal"}),Object(x.jsx)(p.a,{color:"primary",onClick:function(){return R("defense")},disabled:te("defense","add"),children:Object(x.jsx)(X.a,{})})]}),Object(x.jsxs)(T.a,{container:!0,item:!0,direction:"row",justify:"center",children:[Object(x.jsx)(p.a,{color:"primary",onClick:function(){return ee("magik")},disabled:te("magik","remove"),children:Object(x.jsx)(K.a,{})}),Object(x.jsx)(H.a,{name:"magik",label:"Magie",id:"magik",disabled:!0,value:$,margin:"normal"}),Object(x.jsx)(p.a,{color:"primary",onClick:function(){return R("magik")},disabled:te("magik","add"),children:Object(x.jsx)(X.a,{})})]})]})}),Object(x.jsxs)(_.a,{children:[Object(x.jsx)(p.a,{onClick:z,color:"primary",children:"Annuler"}),Object(x.jsx)(p.a,{type:"submit",color:"primary",children:"Valider"})]})]})]})}var te,ne,ae,re=n(64),ie=Object(O.a)((function(e){return{create:{color:"white",textDecoration:"none"},empty:{height:"100%"},chargrid:{padding:"1rem"},charLabel:{padding:"1rem",textAlign:"center","&:hover":{cursor:"pointer"}},disabled:{padding:"1rem",textAlign:"center",backgroundColor:"lightslategrey","&:hover":{cursor:"not-allowed"}}}})),ce=Object(o.gql)(te||(te=Object(q.a)(["\n    query characters($userId: String){\n        characters(userId: $userId) {\n            name\n            rank\n            skillpoints\n            attack\n            health\n            defense\n            magik\n            id\n            lastFight\n        }\n    }\n"]))),oe=Object(o.gql)(ne||(ne=Object(q.a)(["\n    query fightsForCharacter($charId: String){\n        fightsForCharacter(charId: $charId){\n            id\n            player{\n                name\n            }\n            enemy{name}\n            winner{id}\n            looser{id}\n            date\n        }\n    }\n"])));function se(e){var t=ie(),n=Object(a.useState)(),r=Object(j.a)(n,2),i=r[0],c=r[1],s=Object(a.useState)(),d=Object(j.a)(s,2),u=d[0],b=d[1],m=Object(a.useState)(),O=Object(j.a)(m,2),v=O[0],f=O[1],y=Object(a.useState)(),k=Object(j.a)(y,2),I=k[0],S=k[1],C=Object(a.useState)(!1),w=Object(j.a)(C,2),N=w[0],M=w[1],q=Object(a.useState)(!1),P=Object(j.a)(q,2),A=P[0],F=P[1],E=Object(a.useState)(!1),L=Object(j.a)(E,2),$=L[0],V=L[1],z=h(),J=Object(R.a)(null===z||void 0===z?void 0:z.token).decodedToken,B=Object(o.useLazyQuery)(ce,{fetchPolicy:"no-cache"}),G=Object(j.a)(B,2),Q=G[0],U=G[1],H=U.loading,_=U.data,K=Object(o.useLazyQuery)(oe),X=Object(j.a)(K,2),Y=X[0],Z=X[1],te=Z.data,ne=Z.error,ae=function(e){var t=re.DateTime.now(),n=re.DateTime.fromMillis(parseInt(null===e||void 0===e?void 0:e.lastFight));return t.diff(n,"hours").hours>1||!e.lastFight};if(Object(a.useEffect)((function(){((null===J||void 0===J?void 0:J.id)&&!i||N)&&(I||S(J.id),Q({variables:{userId:J.id}}),M(!1)),_&&(console.log("Character list:: ".concat(JSON.stringify(_))),c(_.characters)),te&&(console.log("fights:: ".concat(JSON.stringify(te))),f(te.fightsForCharacter))}),[I,J,_,Q,N,te,ne,i]),H)return Object(x.jsx)("div",{children:"loading"});var se=(null===i||void 0===i?void 0:i.length)<10;return!i||(null===i||void 0===i?void 0:i.length)<=0?Object(x.jsx)(T.a,{container:!0,direction:"row",justify:"center",className:t.empty,children:Object(x.jsx)(le,{userId:I,action:M})}):Object(x.jsxs)(T.a,{container:!0,direction:"row",children:[Object(x.jsxs)(T.a,{container:!0,item:!0,xs:6,direction:"column",children:[null===i||void 0===i?void 0:i.map((function(e){return Object(x.jsx)(T.a,{onClick:function(){return function(e){var t=null===i||void 0===i?void 0:i.find((function(t){return t.id===e}));t&&ae(t)&&(b(t),console.log("getting history"),Y({variables:{charId:e}}))}(e.id)},className:t.chargrid,children:Object(x.jsx)(D.a,{className:ae(e)?t.charLabel:t.disabled,children:Object(x.jsxs)(T.a,{container:!0,item:!0,direction:"row",justify:"space-evenly",alignItems:"center",children:[e.name," Niveau ",e.rank,e.skillpoints>0?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(p.a,{onClick:function(){return F(!0)},color:"primary",variant:"outlined",children:"Monter de niveau"}),Object(x.jsx)(ee,{open:A,userId:I,action:M,character:e})]}):void 0]})})},e.id)})),se?Object(x.jsx)(le,{userId:I,action:M}):void 0]}),Object(x.jsx)(T.a,{container:!0,item:!0,xs:6,direction:"column",alignItems:"center",justify:"center",children:u?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(T.a,{item:!0,container:!0,justify:"center",alignItems:"center",direction:"column",md:4,className:t.chargrid,children:Object(x.jsx)(W,{character:u})}),Object(x.jsxs)(T.a,{item:!0,container:!0,alignItems:"center",justify:"space-evenly",direction:"row",children:[(null===v||void 0===v?void 0:v.length)>0?Object(x.jsx)(p.a,{color:"primary",variant:"outlined",onClick:function(){return V(!$)},children:"Historique"}):void 0,Object(x.jsx)(p.a,{color:"primary",variant:"contained",children:Object(x.jsx)(l.b,{to:"/arena?charId=".concat(u.id),className:t.create,children:"Entrer dans l'ar\xe8ne"})})]}),$?Object(x.jsx)(T.a,{item:!0,container:!0,direction:"column",justify:"center",alignItems:"center",hidden:$,children:null===v||void 0===v?void 0:v.map((function(e){return Object(x.jsx)(D.a,{style:{padding:"1rem"},children:Object(x.jsxs)(T.a,{container:!0,item:!0,direction:"column",justify:"center",alignItems:"center",children:[Object(x.jsxs)(g.a,{variant:"body1",children:["Le ",re.DateTime.fromMillis(parseInt(e.date)).toLocaleString(re.DateTime.DATETIME_MED)]}),Object(x.jsxs)(g.a,{variant:"body1",children:["Contre ",e.enemy.name]}),Object(x.jsx)(g.a,{variant:"body1",children:e.winner.id===u.id?"Victoire":"Defaite"})]})},null===v||void 0===v?void 0:v.indexOf(e))}))}):void 0]}):void 0})]})}function le(e){var t=ie(),n=Object(a.useState)(!1),r=Object(j.a)(n,2),i=r[0],c=r[1];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(p.a,{variant:"contained",color:"primary",className:t.create,onClick:function(){c(!0)},children:"Nouveau Personnage"}),Object(x.jsx)(ee,{open:i,userId:e.userId,action:e.action})]})}var de,ue=Object(O.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),je=Object(o.gql)(ae||(ae=Object(q.a)(["\n    mutation login($user: LoginInput!) {\n        login(user: $user)\n    }\n    \n"])));function be(){var e=ue(),t=Object(a.useState)(),n=Object(j.a)(t,2),r=n[0],i=n[1],c=Object(a.useState)(),s=Object(j.a)(c,2),b=s[0],m=s[1],O=Object(o.useMutation)(je),v=Object(j.a)(O,2),f=v[0],y=v[1].error,k=Object(d.g)(),I=Object(d.h)(),S=h(),C=(I.state||{from:{pathname:"/"}}).from;console.log(C);var w=function(e){switch(e.target.name){case"username":i(e.target.value);break;case"pwd":m(e.target.value)}},q=function(){var e=Object(M.a)(N.a.mark((function e(t){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,f({variables:{user:{username:r,pwd:b}}});case 4:n=e.sent,console.log(n.data.login),null===S||void 0===S||S.signin(n.data.login,(function(){k.replace(C)})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)(u.a,{component:"main",maxWidth:"xs",children:[Object(x.jsx)(G.a,{}),Object(x.jsxs)("div",{className:e.paper,children:[Object(x.jsx)(g.a,{component:"h1",variant:"h5",children:"Connexion"}),Object(x.jsx)("form",{className:e.form,onSubmit:q,children:Object(x.jsxs)(T.a,{container:!0,direction:"column",children:[Object(x.jsx)(H.a,{variant:"outlined",type:"email",name:"username",id:"username",label:"Adresse email",margin:"normal",required:!0,fullWidth:!0,onChange:w}),Object(x.jsx)(H.a,{variant:"outlined",type:"password",label:"Mot de Passe",id:"pwd",name:"pwd",margin:"normal",required:!0,fullWidth:!0,onChange:w}),Object(x.jsx)(p.a,{variant:"contained",type:"submit",color:"primary",className:e.submit,children:"Connexion"}),y?Object(x.jsx)(g.a,{variant:"subtitle1",style:{color:"red"},children:y.message}):void 0]})}),Object(x.jsxs)(g.a,{variant:"subtitle1",children:["Pas encore de compte? ",Object(x.jsx)(l.b,{to:"/signup",children:"Cr\xe9ez en un ici!"})]})]})]})}var he=Object(O.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),me=Object(P.a)(de||(de=Object(q.a)(["\n    mutation signup($user: UserInput!) {\n        signup(user: $user){\n            token\n        }\n    }\n"])));function Oe(){var e=he(),t=Object(a.useState)(),n=Object(j.a)(t,2),r=n[0],i=n[1],c=Object(a.useState)(),s=Object(j.a)(c,2),l=s[0],b=s[1],m=Object(a.useState)(),O=Object(j.a)(m,2),v=O[0],f=O[1],y=Object(a.useState)(),k=Object(j.a)(y,2),I=k[0],S=k[1],C=Object(o.useMutation)(me),w=Object(j.a)(C,2),q=w[0],D=w[1].error,P=h(),A=Object(d.g)(),F=!0,E=function(e){switch(e.target.name){case"username":i(e.target.value);break;case"pwd":b(e.target.value);break;case"lastname":S(e.target.value);break;case"firstname":f(e.target.value);break;case"pwd-confirm":F=e.target.value&&e.target.value===l}},L=function(){var e=Object(M.a)(N.a.mark((function e(t){var n,a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={username:r,pwd:l,firstname:v,lastname:I},e.prev=2,e.next=5,q({variables:{user:n}});case 5:a=e.sent,console.log(a),null===P||void 0===P||P.signin(a.data.token),A.push("/character-select"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)(u.a,{component:"main",maxWidth:"xs",children:[Object(x.jsx)(G.a,{}),Object(x.jsxs)("div",{className:e.paper,children:[Object(x.jsx)(g.a,{component:"h1",variant:"h5",children:"Cr\xe9ez votre compte"}),Object(x.jsx)("form",{className:e.form,onSubmit:L,autoComplete:"off",children:Object(x.jsxs)(T.a,{container:!0,direction:"column",children:[Object(x.jsx)(H.a,{variant:"outlined",type:"text",label:"Nom",id:"lastname",name:"lastname",margin:"normal",required:!0,fullWidth:!0,onChange:E}),Object(x.jsx)(H.a,{variant:"outlined",type:"text",label:"Pr\xe9nom",id:"firstname",name:"firstname",margin:"normal",required:!0,fullWidth:!0,onChange:E}),Object(x.jsx)(H.a,{variant:"outlined",type:"email",name:"username",id:"username",label:"Adresse email",margin:"normal",required:!0,fullWidth:!0,onChange:E}),Object(x.jsx)(H.a,{variant:"outlined",type:"password",label:"Mot de Passe",id:"pwd",name:"pwd",margin:"normal",required:!0,fullWidth:!0,onChange:E}),Object(x.jsx)(H.a,{variant:"outlined",type:"password",label:"Confirmer le Mot de Passe",id:"pwd-confirm",name:"pwd-confirm",margin:"normal",required:!0,fullWidth:!0,onChange:E,error:!F}),Object(x.jsx)(p.a,{variant:"contained",type:"submit",color:"primary",className:e.submit,children:"Connexion"}),D?Object(x.jsx)(g.a,{variant:"subtitle1",style:{color:"red"},children:D.message}):void 0]})})]})]})}function ve(){var e=new URLSearchParams(Object(d.h)().search);return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(d.b,{exact:!0,path:"/",children:Object(x.jsx)(C.a,{})}),Object(x.jsx)(d.b,{exact:!0,path:"/signup",children:Object(x.jsx)(Oe,{})}),Object(x.jsx)(d.b,{exact:!0,path:"/signin",children:Object(x.jsx)(be,{})}),Object(x.jsx)(fe,{path:"/character-select",children:Object(x.jsx)(se,{})}),Object(x.jsx)(fe,{path:"/arena",children:Object(x.jsx)(z,{charId:e.get("charId")})})]})}function fe(e){var t=e.children,n=Object(S.a)(e,["children"]),a=h();return console.log(a),Object(x.jsx)(d.b,Object(I.a)(Object(I.a)({},n),{},{render:function(e){var n=e.location;return(null===a||void 0===a?void 0:a.token)?t:Object(x.jsx)(d.a,{to:{pathname:"/signin",state:{from:n}}})}}))}function ge(e){var t=e.children,n=function(){var e=Object(a.useState)(sessionStorage.getItem("token")),t=Object(j.a)(e,2),n=t[0],r=t[1];return{token:n,signin:function(e,t){if(console.log(e),e)return m.signin((function(){sessionStorage.setItem("token",e),r(e),t()}))},signout:function(e){return m.signout((function(){sessionStorage.removeItem("token"),r(null),e()}))}}}();return Object(x.jsx)(b.Provider,{value:n,children:t})}var pe=function(){var e=new o.ApolloClient({uri:"graphql",cache:new o.InMemoryCache});return Object(x.jsx)(u.a,{className:"master",children:Object(x.jsx)(s.ApolloProvider,{client:e,children:Object(x.jsx)(ge,{children:Object(x.jsxs)(l.a,{children:[Object(x.jsx)(k,{}),Object(x.jsx)(d.d,{children:Object(x.jsx)(ve,{})})]})})})})},xe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,196)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),i(e),c(e)}))};c.a.render(Object(x.jsx)(r.a.StrictMode,{children:Object(x.jsx)(pe,{})}),document.getElementById("root")),xe()}},[[143,1,2]]]);
//# sourceMappingURL=main.0624998f.chunk.js.map